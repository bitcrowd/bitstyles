@use 'sass:map';
@use '../settings/typography';
@use '../settings/setup';
@use 'media-query';
@use 'unit-conversions';

// Output font sizes
//
// **Private mixin**
//
// Used to output font-sizes from a map of font-sizes in `element-name: font-size` pairs.
//
// @param {Map} $font-sizes  A map of font-sizes in `element-name: font-size` pairs. See `typography.$font-sizes` for an example.
//
// @param {String} $prefix  A string to prefix to the ouput selector.
//
// @param {List} $subset  Provide a list of element names for which to output font-sizes. Defaults to include all sizes defined in the `$font-sizes` parameter.
//

@mixin _output-font-sizes($font-sizes, $prefix, $subset) {
  $base-size: typography.$font-size-base-small; // stylelint-disable-line scss/dollar-variable-default

  @if map.has-key($font-sizes, 'html') {
    $base-size: map.get($font-sizes, 'html'); // stylelint-disable-line scss/dollar-variable-default
  }

  @each $element-name, $font-size in ($font-sizes) {
    @if (length($subset) == 0) or (index($subset, $element-name)) {
      #{setup.$namespace}#{$prefix}#{$element-name} {
        /* stylelint-disable max-nesting-depth */
        @if $element-name == 'html' {
          font-size: unit-conversions.px-to-rem($font-size, 16px);
        }

        @else {
          font-size: unit-conversions.px-to-rem($font-size, $base-size);
        }
        /* stylelint-enable max-nesting-depth */
      }
    }
  }
}

// Font-size generator
//
// **Generate your typographic scale**
//
// Set your font-sizes in the map `$bitstyles-font-sizes` e.g.
//
// ```scss
// $bitstyles-font-sizes: (
//   'base': (
//     'html': $bitstyles-font-size-base-small,
//     'h0': 32px,
//     'h1': 24px,
//     'h2': 20px,
//     'h3': 18px,
//     'h4': $bitstyles-font-size-base-small,
//     'h5': $bitstyles-font-size-base-small,
//     'h6': $bitstyles-font-size-base-small
//   ),
//   'm': (
//     'html': $bitstyles-font-size-base,
//     'h0': 86px,
//     'h1': 40px,
//     'h2': 28px,
//     'h3': 20px,
//     'h4': $bitstyles-font-size-base,
//     'h5': $bitstyles-font-size-base,
//     'h6': $bitstyles-font-size-base
//   )
// );
// ```
//
// Use `px` to define font-sizes, the output will specify `rem`s with a `px` fallback.
//
// `base` is a reserved word, and results in font-sizes being output without an enclosing media query.
//
// The media-query names used should be defined in `$bitstyles-breakpoints`.
//
// @param {String} $prefix  Optional. Provide a string that will be prepended to the element name. Can include `.` to output classname selectors instead of elements.
//
// @param {List} $subset  Optional. Provide a list of element names for which to output font-sizes. Defaults to include all sizes defined in `$bitstyles-font-sizes`.
//

@mixin generate-font-sizes($prefix: '', $subset: ()) {
  @each $media-query-name, $font-sizes in typography.$font-sizes {
    // Donâ€™t wrap base classes in a media-query
    @if $media-query-name == 'base' {
      @include _output-font-sizes($font-sizes, $prefix, $subset);
    }

    @else {
      @include media-query.media-query($media-query-name) {
        @include _output-font-sizes($font-sizes, $prefix, $subset);
      }
    }
  }
}
