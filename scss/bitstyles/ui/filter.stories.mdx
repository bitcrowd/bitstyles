import { Canvas, Meta, Story } from '@storybook/addon-docs/blocks';

<Meta title="UI/Data/Filtering" />

# Filtering

## Filter by fixed-value categories

When a user wants to filter a list of objects by fields which have a limited number of set values, present them with a group of checkboxes to choose from. To keep the UI clear, they can be hidden within a well-labelled dropdown menu.

<div class="u-bg-gray-light u-padding-m-x u-padding-xs-y">
  <p>
    These examples use AlpineJS for the behavior. If you’re using a different JS
    package, replace the blocks of html attributes starting with `x-`, and with
    `@click`.
  </p>
</div>

<details class="u-margin-xl-y">
  <summary class="u-h4 u-font-medium">Examples use</summary>
  <ul>
    <li>
      <a href="/docs/atoms-button-base--button-element">a-button</a>
    </li>
    <li>
      <a href="/docs/'atoms-button-secondary--secondary">a-button--secondary</a>
    </li>
    <li>
      <a href="/docs/atoms-button-menu--menu">a-button--transparent</a>
    </li>
    <li>
      <a href="/docs/atoms-dropdown--dropdown">a-dropdown</a>
    </li>
    <li>
      <a href="/docs/organisms-ui-group--ui-group-buttons">o-ui-group</a>
    </li>
    <li>
      <a href="/docs/utilities-flex--flex">u-flex</a>
    </li>
    <li>
      <a href="/docs/utilities-box-alignment--items-center">u-items-center</a>
    </li>
    <li>
      <a href="/docs/atoms-icon--icon">a-icon</a>
    </li>
    <li>
      <a href="/docs/atoms-list-reset--list-reset">u-list-none</a>
    </li>
    <li>
      <a href="/docs/utilities-typography--typography">u-h6</a>
    </li>
    <li>
      <a href="/docs/utilities-margin--margin-m">u-margin</a>
    </li>
    <li>
      <a href="/docs/utilities-overflow--overflow-y">u-overflow-y-auto</a>
    </li>
    <li>
      <a href="/docs/utilities-relative--relative">u-relative</a>
    </li>
    <li>
      <a href="/docs/utilities-sr-only--sr-only">u-sr-only</a>
    </li>
  </ul>
</details>

<Canvas>
  <Story name="Filter by preset values">
    {`
      <div style="min-height: 15rem;">
        <form action="" method="POST" class="u-flex u-items-center" role="search">
          <h3 class="u-sr-only">Filter results</h3>
          <ul class="u-list-none u-flex" x-data="{ dropdownOpen: false }">
            <li class="u-relative u-margin-xs-right">
              <button
                type="button"
                class="a-button a-button--secondary"
                title="Filter by category"
                aria-controls="dropdown-1"
                @click="dropdownOpen = !dropdownOpen"
                :aria-expanded="dropdownOpen"
              >
                <span class="u-sr-only">Filter by</span>
                <span class="a-button__label">Account type: Admin</span>
                <svg class="a-button__icon a-icon a-icon--m" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                  <path d="M2.78,32.83a6.07,6.07,0,0,1,8.58-8.59L45.71,58.59a6.07,6.07,0,0,0,8.58,0L88.64,24.24a6.07,6.07,0,1,1,8.58,8.59L54.29,75.76a6.07,6.07,0,0,1-8.58,0Z" fill-rule="evenodd"/>
                </svg>
              </button>
              <ul
                x-show="dropdownOpen"
                x-transition:enter="is-transitioning"
                x-transition:enter-start="is-off-screen"
                x-transition:enter-end="is-on-screen"
                x-transition:leave="is-transitioning"
                x-transition:leave-start="is-on-screen"
                x-transition:leave-end="is-off-screen"
                @click.away="dropdownOpen = false"
                class="a-dropdown a-dropdown--right u-overflow-y-auto u-list-none u-margin-s-top"
                id="dropdown-1"
              >
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="all" checked />
                    All
                  </label>
                </li>
                <li role="separator"></li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="admin" checked />
                    Admin
                  </label>
                </li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="customer" checked />
                    Customer
                  </label>
                </li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="anon" checked />
                    Anon
                  </label>
                </li>
              </ul>
            </li>
            <li class="u-relative" x-data="{ dropdownOpen: false }">
              <button
                type="button"
                class="a-button a-button--secondary"
                title="Add filter"
                aria-controls="dropdown-2" @click="dropdownOpen = !dropdownOpen"
                :aria-expanded="dropdownOpen"
              >
                <span class="u-sr-only">Filter by</span>
                <span class="a-button__label">Account status: All</span>
                <svg class="a-button__icon a-icon a-icon--m" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                  <path d="M2.78,32.83a6.07,6.07,0,0,1,8.58-8.59L45.71,58.59a6.07,6.07,0,0,0,8.58,0L88.64,24.24a6.07,6.07,0,1,1,8.58,8.59L54.29,75.76a6.07,6.07,0,0,1-8.58,0Z" fill-rule="evenodd"/>
                </svg>
              </button>
              <ul
                x-show="dropdownOpen"
                x-transition:enter="is-transitioning"
                x-transition:enter-start="is-off-screen"
                x-transition:enter-end="is-on-screen"
                x-transition:leave="is-transitioning"
                x-transition:leave-start="is-on-screen"
                x-transition:leave-end="is-off-screen"
                @click.away="dropdownOpen = false"
                class="a-dropdown a-dropdown--right u-overflow-y-auto u-list-none u-margin-s-top"
                id="dropdown-2"
              >
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="all" checked />
                    All
                  </label>
                </li>
                <li role="separator"></li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="invited" checked />
                    Invited
                  </label>
                </li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="activated" checked />
                    Activated
                  </label>
                </li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="banned" checked />
                    Banned
                  </label>
                </li>
              </ul>
            </li>
          </ul>
          <button class="a-button u-sr-only" type="submit">Apply filter</button>
        </form>
      </div>
    `}
  </Story>
</Canvas>

## Free text filters

Some fields such as names and emails will need to be filtered by user-entered free text. Use a dropdown menu to allow the user to narrow down their search by category.

<Canvas isColumn>
  <Story name="Filter by free text">
    {`
      <div style="min-height: 10rem;">
        <form action="" method="POST" role="search">
          <h3 class="u-sr-only">Filter results</h3>
          <ul class="o-ui-group u-flex u-list-none">
            <li class="u-flex">
              <label for="search_users" class="u-sr-only">Search users</label>
              <input type="search" id="search_users" class="o-ui-group__item u-border-radius-0-tr u-border-radius-0-br" placeholder="Search users…" />
            </li>
            <li class="u-flex u-relative" x-data="{ dropdownOpen: false }">
              <button
                type="button"
                class="a-button a-button--secondary u-border-radius-0-tl u-border-radius-0-bl"
                aria-controls="dropdown-1"
                @click="dropdownOpen = !dropdownOpen"
                :aria-expanded="dropdownOpen"
              >
                <span class="a-button__label">Email</span>
                <svg class="a-button__icon a-icon a-icon--m" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" aria-hidden="true">
                  <path d="M2.78,32.83a6.07,6.07,0,0,1,8.58-8.59L45.71,58.59a6.07,6.07,0,0,0,8.58,0L88.64,24.24a6.07,6.07,0,1,1,8.58,8.59L54.29,75.76a6.07,6.07,0,0,1-8.58,0Z" fill-rule="evenodd"/>
                </svg>
              </button>
              <ul
                x-show="dropdownOpen"
                x-transition:enter="is-transitioning"
                x-transition:enter-start="is-off-screen"
                x-transition:enter-end="is-on-screen"
                x-transition:leave="is-transitioning"
                x-transition:leave-start="is-on-screen"
                x-transition:leave-end="is-off-screen"
                @click.away="dropdownOpen = false"
                class="a-dropdown a-dropdown--right u-margin-s-top u-overflow-y-auto u-list-none u-margin-s-bottom"
                id="dropdown-1"
              >
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="email" checked />
                    Email
                  </label>
                </li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="name" checked />
                    Name
                  </label>
                </li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="address" checked />
                    Address
                  </label>
                </li>
              </ul>
            </li>
          </ul>
          <button class="a-button u-sr-only" type="submit">Apply filter</button>
        </form>
      </div>
    `}
  </Story>
</Canvas>

## Multiple filters

When giving the user filters by category and free text, place the free text search field first.

<Canvas>
  <Story name="Filter by free text and categories">
    {`
      <div style="min-height: 10rem;">
        <form action="" method="POST" role="search">
          <h3 class="u-sr-only">Filter results</h3>
          <ul class="u-list-none u-flex u-items-center">
            <li class="u-margin-xs-right">
              <ul class="o-ui-group u-flex u-list-none">
                <li class="u-flex">
                  <label for="search_users" class="u-sr-only">Search users</label>
                  <input type="search" id="search_users" class="o-ui-group__item u-border-radius-0-tr u-border-radius-0-br" placeholder="Search users…" />
                </li>
                <li class="u-flex u-relative" x-data="{ dropdownOpen: false }">
                  <button
                    type="button"
                    class="a-button a-button--secondary u-border-radius-0-tl u-border-radius-0-bl"
                    aria-controls="dropdown-1"
                    @click="dropdownOpen = !dropdownOpen"
                    :aria-expanded="dropdownOpen"
                  >
                    <span class="u-sr-only">Filter field:</span>
                    <span class="a-button__label">All</span>
                    <svg class="a-button__icon a-icon a-icon--m" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" aria-hidden="true">
                      <path d="M2.78,32.83a6.07,6.07,0,0,1,8.58-8.59L45.71,58.59a6.07,6.07,0,0,0,8.58,0L88.64,24.24a6.07,6.07,0,1,1,8.58,8.59L54.29,75.76a6.07,6.07,0,0,1-8.58,0Z" fill-rule="evenodd"/>
                    </svg>
                  </button>
                  <ul
                    x-show="dropdownOpen"
                    x-transition:enter="is-transitioning"
                    x-transition:enter-start="is-off-screen"
                    x-transition:enter-end="is-on-screen"
                    x-transition:leave="is-transitioning"
                    x-transition:leave-start="is-on-screen"
                    x-transition:leave-end="is-off-screen"
                    @click.away="dropdownOpen = false"
                    class="a-dropdown a-dropdown--right u-overflow-y-auto u-list-none u-margin-s-top"
                    id="dropdown-1"
                  >
                    <li>
                      <label class="a-button a-button--transparent u-flex u-items-center">
                        <input type="checkbox" name="field_1" checked />
                        Field 1
                      </label>
                    </li>
                    <li>
                      <label class="a-button a-button--transparent u-flex u-items-center">
                        <input type="checkbox" name="field_2" checked />
                        Field 2
                      </label>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li class="u-relative" x-data="{ dropdownOpen: false }">
              <button
                type="button"
                class="a-button a-button--secondary"
                title="Filter by category"
                aria-controls="dropdown-2"
                @click="dropdownOpen = !dropdownOpen"
                :aria-expanded="dropdownOpen"
              >
                <span class="u-sr-only">Filter by</span>
                <span class="a-button__label">Account type: Admin</span>
                <svg class="a-button__icon a-icon a-icon--m" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                  <path d="M2.78,32.83a6.07,6.07,0,0,1,8.58-8.59L45.71,58.59a6.07,6.07,0,0,0,8.58,0L88.64,24.24a6.07,6.07,0,1,1,8.58,8.59L54.29,75.76a6.07,6.07,0,0,1-8.58,0Z" fill-rule="evenodd"/>
                </svg>
              </button>
              <ul
                x-show="dropdownOpen"
                x-transition:enter="is-transitioning"
                x-transition:enter-start="is-off-screen"
                x-transition:enter-end="is-on-screen"
                x-transition:leave="is-transitioning"
                x-transition:leave-start="is-on-screen"
                x-transition:leave-end="is-off-screen"
                @click.away="dropdownOpen = false"
                class="a-dropdown a-dropdown--right u-overflow-y-auto u-list-none u-margin-s-top"
                id="dropdown-1"
              >
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="admin" checked />
                    Admin
                  </label>
                </li>
                <li>
                  <label class="a-button a-button--transparent u-flex u-items-center">
                    <input type="checkbox" name="customer" checked />
                    Customer
                  </label>
                </li>
              </ul>
            </li>
          </ul>
          <button class="a-button u-sr-only" type="submit">Apply filter</button>
        </form>
      </div>
    `}
  </Story>
</Canvas>
